# 評価フレームワーク定義

MMI評価、DDD評価、ドメイン分類で使用する共通フレームワーク。
参照スキル: evaluate-mmi, mmi-analyzer, ddd-evaluation, integrate-evaluations, ddd-redesign, map-domains, design-microservices

## 1. MMI (Modularity Maturity Index) — 2つのバリアント

本システムではMMIを2つのアプローチで評価できる。

### 1A. 4軸定性評価（`/evaluate-mmi`）

手動の定性評価。マイクロサービス移行準備度を判定する。

| 軸 | 重み | 評価観点 |
|----|------|----------|
| **Cohesion** | 30% | 単一責任原則の遵守度、モジュール内の機能的凝集度 |
| **Coupling** | 30% | 他モジュールへの依存度、インターフェースの明確さ |
| **Independence** | 20% | 独立デプロイ・スケーリング可能性 |
| **Reusability** | 20% | 他ドメインでの再利用可能性 |

**スコア計算:**
```
MMI = (0.3 × Cohesion + 0.3 × Coupling + 0.2 × Independence + 0.2 × Reusability) / 5 × 100
```

各軸は1-5のスケール（5が最高）で評価。

**成熟度レベル:**

| スコア | レベル | 意味 |
|--------|--------|------|
| 80-100 | High | マイクロサービス化準備完了 |
| 60-80 | Medium | 軽微なリファクタリングで移行可能 |
| 40-60 | Low-Medium | 大幅なリファクタリングが必要 |
| 0-40 | Immature | 全面再設計が必要 |

### 1B. Lilienthal 3軸定量評価（`/mmi-analyzer`）

Dr. Carola Lilienthal の手法に基づく自動定量評価。Pythonプロジェクト向け。
Pythonスクリプト（metrics_analyzer, architecture_analyzer, mmi_calculator）で自動計測する。

| カテゴリ | 重み | 主な評価対象 |
|---------|------|------------|
| **Modularity（モジュール性）** | 45% | モジュール分割、インターフェース、プロポーション |
| **Hierarchy（階層性）** | 30% | レイヤー違反、循環依存 |
| **Pattern Consistency（パターン一貫性）** | 25% | パターン適用率、DDD分離 |

**スコア計算:**
```
MMI = Modularity × 0.45 + Hierarchy × 0.30 + Pattern × 0.25
```

各カテゴリは0-10のスケールで評価（閾値テーブルに基づく自動スコアリング）。

**成熟度レベル:**

| スコア | レベル | 意味 |
|--------|--------|------|
| 8-10 | Good | 技術的負債が少ない。保守コスト安定 |
| 4-8 | Warning | 段階的リファクタリングを推奨 |
| 0-4 | Critical | リファクタリング vs 置換の判断が必要 |

**使い分け:**
- **1A**（`/evaluate-mmi`）: 言語非依存、手動定性評価、マイクロサービス移行判断
- **1B**（`/mmi-analyzer`）: Python特化、自動定量評価、技術的負債の数値化
- 両方を実行し、結果を `/integrate-evaluations` で統合することを推奨

## 2. DDD評価チェックリスト

### 戦略的設計

- **境界コンテキスト**: ドメイン境界が明確に定義されているか
- **ユビキタス言語**: ドメイン用語がコードと一貫しているか
- **コンテキストマップ**: コンテキスト間の関係が定義されているか
- **コンテキスト関係パターン**: Shared Kernel / Customer-Supplier / ACL 等

### 戦術的設計

- **エンティティ**: ID識別、ライフサイクル管理が適切か
- **値オブジェクト**: 不変性、バリデーション、ファクトリメソッド
- **集約**: 集約ルート、トランザクション境界が適切か
- **リポジトリ**: ドメイン層のインターフェース、インフラ層の実装分離
- **ドメインサービス**: エンティティに属さないビジネスロジックの配置

## 3. ドメイン分類マトリクス

### ビジネス構造軸

| タイプ | 特徴 | 例 |
|--------|------|-----|
| **Pipeline** | 順次的なデータ/プロセスフロー | 注文処理、ワークフロー |
| **Blackboard** | 共有データに対する協調作業 | 監査セット管理、在庫管理 |
| **Dialogue** | 双方向の対話・インタラクション | チャット、承認フロー |

### マイクロサービス境界軸

| タイプ | 特徴 | トランザクション | 例 |
|--------|------|-----------------|-----|
| **Process** | ビジネスプロセス実行 | Saga/2PC | 注文サービス |
| **Master** | マスターデータ管理 | CRUD中心 | 顧客サービス、商品サービス |
| **Integration** | 外部システム連携 | アダプター | Box連携、決済連携 |
| **Supporting** | 横断的関心事 | 軽量 | 認証、通知、ログ |
